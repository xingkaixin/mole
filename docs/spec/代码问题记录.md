# Mole 现有代码问题记录

| 序号 | 模块/文件 | 问题描述 | 影响范围 | 建议处理 |
| --- | --- | --- | --- | --- |
| 1 | `backend/storage.go`<br>`GetAnalysisResults` / `GetAllAnalysisResults` | 查询语句选择了 `connection_id` 字段，但在 `createTables` 中创建的 `analysis_results` 表并不存在该列，运行时会返回 SQL 错误。 | 前端无法读取任意分析结果，影响历史记录列表和任务结果查看。 | 在表结构中补充 `connection_id` 字段并写入数据，或调整查询逻辑改为通过 `tasks_tbls`/`metadata_tables` 关联获取连接信息。 |
| 2 | `backend/storage.go`<br>`GetAnalysisResult` / `GetEnhancedAnalysisResult` / `GetTaskTableAnalysisResult` | `AnalysisResult.DatabaseID` 被用来暂存 `table_id`，导致返回给前端的 `databaseId` 实际上是表ID，连接信息丢失；同时 `GetTaskTableAnalysisResult` 未给 `result.DatabaseID` 赋值。 | 前端无法准确区分同一表在不同连接下的分析结果，增强详情页中需要手动推断元数据。 | 为分析结果结构新增显式的 `tableId`/`connectionId` 字段，或在返回结果前补齐并使用语义化字段名。 |
| 3 | `Makefile` | `help` 目标输出包含 `make build-linux`，但文件中并未实现该目标，按照提示执行会失败。 | 影响开发者遵循命令行提示，增加上手成本。 | 补充 `build-linux` 目标或从 `help` 输出中移除该命令。 |
| 4 | `frontend/src/components/forms/DatabaseConfigForm.tsx` | 数据库类型下拉选项的值为 `"MySQL"`，而全局默认配置使用 `"mysql"`，保存后会出现大小写混合，欢迎页的类型过滤结果不可预期。 | 连接筛选条件不一致，可能导致类型过滤失效。 | 统一数据库类型枚举值（例如全局使用小写 `mysql`），并在下拉中保持与后端一致。 |

> 说明：以上问题基于当前 `main` 分支代码审查结果整理，建议在修复前建立针对性测试用例验证。 
